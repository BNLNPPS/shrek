Parameters:
  name:         EventCombine
  comment:      "Top level calorimeter chain"
  nEvents:      $nevents
  nEventsMax:   400
  nRepeat:      $nrepeat
  RunMC:        6
  RunRaw:       329
  OutDir:       . 
  pfnList:      filelist
  nFilesPerJob: 8
  macro:        Fun4All_CombineListEmcal.C
  memory:       2048
  cpuTimePerEvent: 75000

Resources:
  - file: ../macros/eventcombine/Fun4All_CombineListEmcal.C

OutputDataSets:
  - name: EventCombine/outDS
    filelist:
      - "regex|beam_emcal-00009245-0000*"
      - "regex|beam_emcal-00009245-0001*"
      - "regex|beam_emcal-00009245-0002*"
      - "regex|beam_emcal-00009245-0003*"
      - "regex|beam_emcal-00009245-0004*"
      - "regex|beam_emcal-00009245-0005*"
      - "regex|beam_emcal-00009245-0006*"
      - "regex|beam_emcal-00009245-0007*"
      - "regex|beam_emcal-00009245-0008*"
      - "regex|beam_emcal-00009245-0009*"

JobCommands: |-

  # Initialize environment... using the "build" environment, unless it
  # was not specified
  if [ -z ${build+x} ]; then 
     echo "build is unset [default to latest]"
     source /opt/sphenix/core/bin/sphenix_setup.sh -n 
  else 
     echo "build is set to ${build}"
     source /opt/sphenix/core/bin/sphenix_setup.sh -n ${build}
  fi  

  echo ..........................................................................
  echo Running ${name} ${runNumber} $@
  echo ..........................................................................

  # Input is a pfnlist... but really, we ignore it.  The sebXX.list files should be
  # packed and ready to go...

  # Run fun4all
  root -q -b ${macro}\(${nEvents},\"seb00.list\",\"seb01.list\",\"seb02.list\",\"seb03.list\",\"seb04.list\",\"seb05.list\",\"seb06.list\",\"seb07.list\"\)

  # appends the panda task ID to the matching files
  echo ls before append .......
  append_task_id "*.prdf" .prdf
  echo ls after append .......
  
  stash_job_log




